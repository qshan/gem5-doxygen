<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gem5: dev/arm/ufs_device.hh File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gem5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5fc0168d11760b9445bd29fa15d9290f.html">dev</a></li><li class="navelem"><a class="el" href="dir_ad1153afec1dfeb24927e7a8e958206e.html">arm</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a>  </div>
  <div class="headertitle">
<div class="title">ufs_device.hh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is a base class for UFS devices The UFS interface consists out of one host controller which connects a number of devices which together contain up to 8 logic units.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;deque&gt;</code><br />
<code>#include &quot;<a class="el" href="addr__range_8hh_source.html">base/addr_range.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="bitfield_8hh_source.html">base/bitfield.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="statistics_8hh_source.html">base/statistics.hh</a>&quot;</code><br />
<code>#include &quot;debug/UFSHostDevice.hh&quot;</code><br />
<code>#include &quot;<a class="el" href="abstract__nvm_8hh_source.html">dev/arm/abstract_nvm.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="base__gic_8hh_source.html">dev/arm/base_gic.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="disk__image_8hh_source.html">dev/storage/disk_image.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dma__device_8hh_source.html">dev/dma_device.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="io__device_8hh_source.html">dev/io_device.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="packet_8hh_source.html">mem/packet.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="packet__access_8hh_source.html">mem/packet_access.hh</a>&quot;</code><br />
<code>#include &quot;params/UFSHostDevice.hh&quot;</code><br />
<code>#include &quot;<a class="el" href="serialize_8hh_source.html">sim/serialize.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sim_2stats_8hh_source.html">sim/stats.hh</a>&quot;</code><br />
</div>
<p><a href="ufs__device_8hh_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUFSHostDevice.html">UFSHostDevice</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">UFS command flow state machine digraph CommandFlow{ node [fontsize=10]; IDLE -&gt; transferHandler [ label=" transfer/task/command request " fontsize=6]; transferHandler -&gt; command [ label=" It is a command " fontsize=6]; command -&gt; IDLE [ label=" Command done, no further action " fontsize=6]; transferHandler -&gt; <a class="el" href="structUFSHostDevice_1_1taskStart.html" title="Task start information. ">taskStart</a> [ label=" It is a task " fontsize=6]; <a class="el" href="structUFSHostDevice_1_1taskStart.html" title="Task start information. ">taskStart</a> -&gt; finalUTP [ label=" Task handled, now acknowledge (UFS) " fontsize=6]; transferHandler -&gt; <a class="el" href="structUFSHostDevice_1_1transferStart.html" title="Transfer start information. ">transferStart</a> [ label=" It is a transfer " fontsize=6]; <a class="el" href="structUFSHostDevice_1_1transferStart.html" title="Transfer start information. ">transferStart</a> -&gt; SCSIResume [ label=" Transfer, obtain the specific command " fontsize=6]; SCSIResume -&gt; DiskDataFlowPhase [ label=" Disk data transfer (see other graphs) " fontsize=6]; SCSIResume -&gt; DeviceDataPhase [ label=" Device info transfer (handled in SCSIResume) " fontsize=6]; DiskDataFlowPhase -&gt; transferDone [ label=" Transfer done, acknowledge SCSI command " fontsize=6]; DeviceDataPhase -&gt; transferDone [ label=" Transfer done, acknowledge SCSI command " fontsize=6]; transferDone -&gt; finalUTP [ label=" Transfer handled, now acknowledge (UFS) " fontsize=6]; finalUTP -&gt; readDone [ label=" All handled, clear data structures " fontsize=6]; readDone -&gt; IDLE [ label=" All handled, nothing outstanding " fontsize=6]; readDone -&gt; transferHandler [ label=" All handled, handle next outstanding " fontsize=6]; }.  <a href="classUFSHostDevice.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1HCIMem.html">UFSHostDevice::HCIMem</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Host Controller Interface This is a set of registers that allow the driver to control the transactions to the flash devices.  <a href="structUFSHostDevice_1_1HCIMem.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPUPIUHeader.html">UFSHostDevice::UTPUPIUHeader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">All the data structures are defined in the UFS standard This standard be found at the JEDEC website free of charge (login required): <a href="http://www.jedec.org/standards-documents/results/jesd220">http://www.jedec.org/standards-documents/results/jesd220</a>.  <a href="structUFSHostDevice_1_1UTPUPIUHeader.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPUPIURSP.html">UFSHostDevice::UTPUPIURSP</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UTPUPIURSP.html" title="struct UTPUPIURSP - Response UPIU structure header: UPIU header DW-0 to DW-2 residualTransferCount: R...">UTPUPIURSP</a> - Response UPIU structure header: UPIU header DW-0 to DW-2 residualTransferCount: Residual transfer count DW-3 reserved: Reserved DW-4 to DW-7 senseDataLen: Sense data length DW-8 U16 senseData: Sense data field DW-8 to DW-12  <a href="structUFSHostDevice_1_1UTPUPIURSP.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPUPIUTaskReq.html">UFSHostDevice::UTPUPIUTaskReq</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UTPUPIUTaskReq.html" title="struct UTPUPIUTaskReq - Task request UPIU structure header - UPIU header structure DW0 to DW-2 inputP...">UTPUPIUTaskReq</a> - Task request UPIU structure header - UPIU header structure DW0 to DW-2 inputParam1: Input param 1 DW-3 inputParam2: Input param 2 DW-4 inputParam3: Input param 3 DW-5 reserved: Reserver DW-6 to DW-7  <a href="structUFSHostDevice_1_1UTPUPIUTaskReq.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UFSHCDSGEntry.html">UFSHostDevice::UFSHCDSGEntry</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UFSHCDSGEntry.html" title="struct UFSHCDSGEntry - UFSHCI PRD Entry baseAddr: Lower 32bit physical address DW-0 upperAddr: Upper ...">UFSHCDSGEntry</a> - UFSHCI PRD Entry baseAddr: Lower 32bit physical address DW-0 upperAddr: Upper 32bit physical address DW-1 reserved: Reserved for future use DW-2 size: size of physical segment DW-3  <a href="structUFSHostDevice_1_1UFSHCDSGEntry.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPTransferCMDDesc.html">UFSHostDevice::UTPTransferCMDDesc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UTPTransferCMDDesc.html" title="struct UTPTransferCMDDesc - UFS Commad Descriptor structure commandUPIU: Command UPIU Frame address r...">UTPTransferCMDDesc</a> - UFS Commad Descriptor structure commandUPIU: Command UPIU Frame address responseUPIU: Response UPIU Frame address PRDTable: Physcial Region Descriptor All lengths as defined by JEDEC220  <a href="structUFSHostDevice_1_1UTPTransferCMDDesc.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UPIUMessage.html">UFSHostDevice::UPIUMessage</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">UPIU tranfer message.  <a href="structUFSHostDevice_1_1UPIUMessage.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPTransferReqDesc.html">UFSHostDevice::UTPTransferReqDesc</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UTPTransferReqDesc.html" title="struct UTPTransferReqDesc - UTRD structure header: UTRD header DW-0 to DW-3 commandDescBaseAddrLo: UC...">UTPTransferReqDesc</a> - UTRD structure header: UTRD header DW-0 to DW-3 commandDescBaseAddrLo: UCD base address low DW-4 commandDescBaseAddrHi: UCD base address high DW-5 responseUPIULength: response UPIU length DW-6 responseUPIUOffset: response UPIU offset DW-6 PRDTableLength: Physical region descriptor length DW-7 PRDTableOffset: Physical region descriptor offset DW-7  <a href="structUFSHostDevice_1_1UTPTransferReqDesc.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UTPTransferReqDesc_1_1RequestDescHeader.html">UFSHostDevice::UTPTransferReqDesc::RequestDescHeader</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct <a class="el" href="structUFSHostDevice_1_1UTPTransferReqDesc_1_1RequestDescHeader.html" title="struct RequestDescHeader dword0: Descriptor Header DW0 dword1: Descriptor Header DW1 dword2: Descript...">RequestDescHeader</a> dword0: Descriptor Header DW0 dword1: Descriptor Header DW1 dword2: Descriptor Header DW2 dword3: Descriptor Header DW3  <a href="structUFSHostDevice_1_1UTPTransferReqDesc_1_1RequestDescHeader.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1SCSIReply.html">UFSHostDevice::SCSIReply</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">SCSI reply structure.  <a href="structUFSHostDevice_1_1SCSIReply.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1LUNInfo.html">UFSHostDevice::LUNInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Logic unit information structure.  <a href="structUFSHostDevice_1_1LUNInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1transferInfo.html">UFSHostDevice::transferInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Different events, and scenarios require different types of information.  <a href="structUFSHostDevice_1_1transferInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1transferDoneInfo.html">UFSHostDevice::transferDoneInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">transfer completion info.  <a href="structUFSHostDevice_1_1transferDoneInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1transferStart.html">UFSHostDevice::transferStart</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transfer start information.  <a href="structUFSHostDevice_1_1transferStart.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1taskStart.html">UFSHostDevice::taskStart</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Task start information.  <a href="structUFSHostDevice_1_1taskStart.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1SCSIResumeInfo.html">UFSHostDevice::SCSIResumeInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">After a SCSI command has been identified, the SCSI resume function will handle it.  <a href="structUFSHostDevice_1_1SCSIResumeInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1writeToDiskBurst.html">UFSHostDevice::writeToDiskBurst</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Disk transfer burst information.  <a href="structUFSHostDevice_1_1writeToDiskBurst.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structUFSHostDevice_1_1UFSHostDeviceStats.html">UFSHostDevice::UFSHostDeviceStats</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Statistics.  <a href="structUFSHostDevice_1_1UFSHostDeviceStats.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classUFSHostDevice_1_1UFSSCSIDevice.html">UFSHostDevice::UFSSCSIDevice</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">device layer: This is your Logic unit This layer implements the SCSI functionality of the UFS Device One logic unit controls one or more disk partitions  <a href="classUFSHostDevice_1_1UFSSCSIDevice.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is a base class for UFS devices The UFS interface consists out of one host controller which connects a number of devices which together contain up to 8 logic units. </p>
<p>A Logical Unit is an externally addressable, independent, processing entity that processes SCSI tasks (commands) and performs task management functions. The decision has been made to abstract the device away, and model the different logic units. Effectively this means that there is one Host layer which handles all the UFS commands (everything UTP, UPIU and UNIpro related) and a SCSI layer, which handles the SCSI interpretation and the interaction with the "disk" (effectively the LBA that that particular Logic Unit controls). Each Logic unit should therefor control a disk image and a timing model. The UFS protocol has three types of commands (explained later). Each has different phases and each phase need to wait for its particular data. This is the reason that this model contains a lot of events. For clarity, a state diagram in doxygen has been provided. To fully apreciate the stages that the model flows through, the states have been broken into three state diagrams. It is best if one imagines the command flow state machine to be happening in the UFSHost layer, and the other two to flow through all the layers of the model (UFS host, SCSI and NVM model). See it as a quarry, one state diagram is moving the crane into place, and the other ones are transporting the dirt down, or the valuables up. For complete information about the working of UFS please refer to <a href="http://www.jedec.org/standards-documents/results/jesd220">http://www.jedec.org/standards-documents/results/jesd220</a> or <a href="http://www.jedec.org/standards-documents/results/jesd223">http://www.jedec.org/standards-documents/results/jesd223</a> The documents are available free of charge, although you will need to have an acount. </p>

<p class="definition">Definition in file <a class="el" href="ufs__device_8hh_source.html">ufs_device.hh</a>.</p>
</div></div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
Generated on Mon Nov 25 2019 12:52:13 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.8.13</small></address>
</body>
</html>
