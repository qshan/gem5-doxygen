<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gem5: DrainManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gem5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classDrainManager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DrainManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class coordinates draining of a <a class="el" href="classSystem.html">System</a>.  
 <a href="classDrainManager.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="drain_8hh_source.html">drain.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8b3fc7aff27e4080eddcb5c31b5a508c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a8b3fc7aff27e4080eddcb5c31b5a508c">tryDrain</a> ()</td></tr>
<tr class="memdesc:a8b3fc7aff27e4080eddcb5c31b5a508c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Try to drain the system.  <a href="#a8b3fc7aff27e4080eddcb5c31b5a508c">More...</a><br /></td></tr>
<tr class="separator:a8b3fc7aff27e4080eddcb5c31b5a508c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58763f931c0110552a8113b87a8a6b0a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a58763f931c0110552a8113b87a8a6b0a">resume</a> ()</td></tr>
<tr class="memdesc:a58763f931c0110552a8113b87a8a6b0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resume normal simulation in a Drained system.  <a href="#a58763f931c0110552a8113b87a8a6b0a">More...</a><br /></td></tr>
<tr class="separator:a58763f931c0110552a8113b87a8a6b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49febb0b5e020ebcd63eb156e2e15dc2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a49febb0b5e020ebcd63eb156e2e15dc2">preCheckpointRestore</a> ()</td></tr>
<tr class="memdesc:a49febb0b5e020ebcd63eb156e2e15dc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run state fixups before a checkpoint restore operation.  <a href="#a49febb0b5e020ebcd63eb156e2e15dc2">More...</a><br /></td></tr>
<tr class="separator:a49febb0b5e020ebcd63eb156e2e15dc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c9c8ff5a0a15b31dcdf4c63fa384b16"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a4c9c8ff5a0a15b31dcdf4c63fa384b16">isDrained</a> () const</td></tr>
<tr class="memdesc:a4c9c8ff5a0a15b31dcdf4c63fa384b16"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classCheck.html">Check</a> if the system is drained.  <a href="#a4c9c8ff5a0a15b31dcdf4c63fa384b16">More...</a><br /></td></tr>
<tr class="separator:a4c9c8ff5a0a15b31dcdf4c63fa384b16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0faa0b57b1c33a16bd616c51a6ec24f9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a0faa0b57b1c33a16bd616c51a6ec24f9">state</a> () const</td></tr>
<tr class="memdesc:a0faa0b57b1c33a16bd616c51a6ec24f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the simulators global drain state.  <a href="#a0faa0b57b1c33a16bd616c51a6ec24f9">More...</a><br /></td></tr>
<tr class="separator:a0faa0b57b1c33a16bd616c51a6ec24f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd134e8277be09e702b63f36f6ee31d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#abd134e8277be09e702b63f36f6ee31d0">signalDrainDone</a> ()</td></tr>
<tr class="memdesc:abd134e8277be09e702b63f36f6ee31d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Notify the <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> that a <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> object has finished draining.  <a href="#abd134e8277be09e702b63f36f6ee31d0">More...</a><br /></td></tr>
<tr class="separator:abd134e8277be09e702b63f36f6ee31d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a950827933fa0746e54fb7648e21660a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a950827933fa0746e54fb7648e21660a0">registerDrainable</a> (<a class="el" href="classDrainable.html">Drainable</a> *obj)</td></tr>
<tr class="separator:a950827933fa0746e54fb7648e21660a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b585f2ca6a932300c404d571eac704"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#ad6b585f2ca6a932300c404d571eac704">unregisterDrainable</a> (<a class="el" href="classDrainable.html">Drainable</a> *obj)</td></tr>
<tr class="separator:ad6b585f2ca6a932300c404d571eac704"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:afcd941bb5f78d0aaf483fcd10efa477a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classDrainManager.html">DrainManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#afcd941bb5f78d0aaf483fcd10efa477a">instance</a> ()</td></tr>
<tr class="memdesc:afcd941bb5f78d0aaf483fcd10efa477a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the singleton <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> instance.  <a href="#afcd941bb5f78d0aaf483fcd10efa477a">More...</a><br /></td></tr>
<tr class="separator:afcd941bb5f78d0aaf483fcd10efa477a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:aba73431ea98bae43f9bb07892b4f461b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#aba73431ea98bae43f9bb07892b4f461b">DrainManager</a> ()</td></tr>
<tr class="separator:aba73431ea98bae43f9bb07892b4f461b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ebecf31e9536b80bc5b37c1d4f8e226"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a4ebecf31e9536b80bc5b37c1d4f8e226">DrainManager</a> (<a class="el" href="classDrainManager.html">DrainManager</a> &amp;)=delete</td></tr>
<tr class="separator:a4ebecf31e9536b80bc5b37c1d4f8e226"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe1e9064b94c3e060015f3aaa4a4fe1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a0fe1e9064b94c3e060015f3aaa4a4fe1">~DrainManager</a> ()</td></tr>
<tr class="separator:a0fe1e9064b94c3e060015f3aaa4a4fe1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5af8422cbcc4e0b70752909a7ee493b0"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a5af8422cbcc4e0b70752909a7ee493b0">allInState</a> (<a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a> <a class="el" href="classDrainManager.html#a0faa0b57b1c33a16bd616c51a6ec24f9">state</a>) const</td></tr>
<tr class="memdesc:a5af8422cbcc4e0b70752909a7ee493b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function to check if all <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects are in a specific state.  <a href="#a5af8422cbcc4e0b70752909a7ee493b0">More...</a><br /></td></tr>
<tr class="separator:a5af8422cbcc4e0b70752909a7ee493b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa18ffee619801a86897cdc745ba8d91b"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#aa18ffee619801a86897cdc745ba8d91b">drainableCount</a> () const</td></tr>
<tr class="memdesc:aa18ffee619801a86897cdc745ba8d91b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thread-safe helper function to get the number of <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects in a system.  <a href="#aa18ffee619801a86897cdc745ba8d91b">More...</a><br /></td></tr>
<tr class="separator:aa18ffee619801a86897cdc745ba8d91b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ae7ad8cefcb557350ac7be5d7fd9ba405"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#ae7ad8cefcb557350ac7be5d7fd9ba405">globalLock</a></td></tr>
<tr class="memdesc:ae7ad8cefcb557350ac7be5d7fd9ba405"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lock protecting the set of drainable objects.  <a href="#ae7ad8cefcb557350ac7be5d7fd9ba405">More...</a><br /></td></tr>
<tr class="separator:ae7ad8cefcb557350ac7be5d7fd9ba405"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadac195f79f459b6c95e944518e389a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classDrainable.html">Drainable</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#aadac195f79f459b6c95e944518e389a7">_allDrainable</a></td></tr>
<tr class="memdesc:aadac195f79f459b6c95e944518e389a7"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="classSet.html">Set</a> of all drainable objects.  <a href="#aadac195f79f459b6c95e944518e389a7">More...</a><br /></td></tr>
<tr class="separator:aadac195f79f459b6c95e944518e389a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57aef09499f30e61d2afb51ea3b45235"><td class="memItemLeft" align="right" valign="top">std::atomic_uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a57aef09499f30e61d2afb51ea3b45235">_count</a></td></tr>
<tr class="memdesc:a57aef09499f30e61d2afb51ea3b45235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of objects still draining.  <a href="#a57aef09499f30e61d2afb51ea3b45235">More...</a><br /></td></tr>
<tr class="separator:a57aef09499f30e61d2afb51ea3b45235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03011ac517c977d4de2d9c968c6cd925"><td class="memItemLeft" align="right" valign="top"><a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#a03011ac517c977d4de2d9c968c6cd925">_state</a></td></tr>
<tr class="memdesc:a03011ac517c977d4de2d9c968c6cd925"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global simulator drain state.  <a href="#a03011ac517c977d4de2d9c968c6cd925">More...</a><br /></td></tr>
<tr class="separator:a03011ac517c977d4de2d9c968c6cd925"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:aad46539173c793271c8c305f30f15c54"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classDrainManager.html">DrainManager</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDrainManager.html#aad46539173c793271c8c305f30f15c54">_instance</a></td></tr>
<tr class="memdesc:aad46539173c793271c8c305f30f15c54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Singleton instance of the drain manager.  <a href="#aad46539173c793271c8c305f30f15c54">More...</a><br /></td></tr>
<tr class="separator:aad46539173c793271c8c305f30f15c54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class coordinates draining of a <a class="el" href="classSystem.html">System</a>. </p>
<p>When draining the simulator, we need to make sure that all <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects within the system have ended up in the drained state before declaring the operation to be successful. This class keeps track of how many objects are still in the process of draining. Once it determines that all objects have drained their state, it exits the simulation loop.</p>
<dl class="section note"><dt>Note</dt><dd>A <a class="el" href="classSystem.html">System</a> might not be completely drained even though the <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> has caused the simulation loop to exit. Draining needs to be restarted until all <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects declare that they don't need further simulation to be completely drained. See <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> for more information. </dd></dl>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00094">94</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aba73431ea98bae43f9bb07892b4f461b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba73431ea98bae43f9bb07892b4f461b">&#9670;&nbsp;</a></span>DrainManager() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DrainManager::DrainManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00052">52</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a5bda814c4aedb126839228f1a3d92f09">Running</a>.</p>

</div>
</div>
<a id="a4ebecf31e9536b80bc5b37c1d4f8e226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ebecf31e9536b80bc5b37c1d4f8e226">&#9670;&nbsp;</a></span>DrainManager() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DrainManager::DrainManager </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainManager.html">DrainManager</a> &amp;&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">delete</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a0fe1e9064b94c3e060015f3aaa4a4fe1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fe1e9064b94c3e060015f3aaa4a4fe1">&#9670;&nbsp;</a></span>~DrainManager()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">DrainManager::~DrainManager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00058">58</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a5af8422cbcc4e0b70752909a7ee493b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5af8422cbcc4e0b70752909a7ee493b0">&#9670;&nbsp;</a></span>allInState()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DrainManager::allInState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a>&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function to check if all <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects are in a specific state. </p>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00177">177</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, and <a class="el" href="drain_8hh_source.html#l00143">state()</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00095">resume()</a>.</p>

</div>
</div>
<a id="aa18ffee619801a86897cdc745ba8d91b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa18ffee619801a86897cdc745ba8d91b">&#9670;&nbsp;</a></span>drainableCount()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t DrainManager::drainableCount </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Thread-safe helper function to get the number of <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects in a system. </p>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00188">188</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00169">globalLock</a>, and <a class="el" href="arch_2x86_2types_8hh_source.html#l00079">X86ISA::lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00134">preCheckpointRestore()</a>, <a class="el" href="drain_8cc_source.html#l00095">resume()</a>, <a class="el" href="drain_8cc_source.html#l00148">signalDrainDone()</a>, and <a class="el" href="drain_8cc_source.html#l00063">tryDrain()</a>.</p>

</div>
</div>
<a id="afcd941bb5f78d0aaf483fcd10efa477a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcd941bb5f78d0aaf483fcd10efa477a">&#9670;&nbsp;</a></span>instance()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classDrainManager.html">DrainManager</a>&amp; DrainManager::instance </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the singleton <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> instance. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00103">103</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="cxx__manager_8cc_source.html#l00627">CxxConfigManager::drain()</a>, <a class="el" href="cxx__manager_8cc_source.html#l00633">CxxConfigManager::drainResume()</a>, and <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="a4c9c8ff5a0a15b31dcdf4c63fa384b16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c9c8ff5a0a15b31dcdf4c63fa384b16">&#9670;&nbsp;</a></span>isDrained()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool DrainManager::isDrained </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classCheck.html">Check</a> if the system is drained. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00140">140</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a8ea1e4c68c45720d9f01e3547de4c0f1">Drained</a>.</p>

<p class="reference">Referenced by <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="a49febb0b5e020ebcd63eb156e2e15dc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49febb0b5e020ebcd63eb156e2e15dc2">&#9670;&nbsp;</a></span>preCheckpointRestore()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DrainManager::preCheckpointRestore </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run state fixups before a checkpoint restore operation. </p>
<p>The drain state of an object isn't stored in a checkpoint since the whole system is always going to be in the Drained state when the checkpoint is created. When the checkpoint is restored at a later stage, recreated objects will be in the Running state since the state isn't stored in checkpoints. This method performs state fixups on all <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> objects and the <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> itself. </p>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00134">134</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00182">_state</a>, <a class="el" href="base_2trace_8hh_source.html#l00215">DPRINTF</a>, <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a8ea1e4c68c45720d9f01e3547de4c0f1">Drained</a>, <a class="el" href="logging_8hh_source.html#l00185">panic_if</a>, and <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a5bda814c4aedb126839228f1a3d92f09">Running</a>.</p>

<p class="reference">Referenced by <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="a950827933fa0746e54fb7648e21660a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a950827933fa0746e54fb7648e21660a0">&#9670;&nbsp;</a></span>registerDrainable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DrainManager::registerDrainable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainable.html">Drainable</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00159">159</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00169">globalLock</a>, and <a class="el" href="arch_2x86_2types_8hh_source.html#l00079">X86ISA::lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00196">Drainable::Drainable()</a>.</p>

</div>
</div>
<a id="a58763f931c0110552a8113b87a8a6b0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58763f931c0110552a8113b87a8a6b0a">&#9670;&nbsp;</a></span>resume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DrainManager::resume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resume normal simulation in a Drained system. </p>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00095">95</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00179">_count</a>, <a class="el" href="drain_8hh_source.html#l00182">_state</a>, <a class="el" href="drain_8cc_source.html#l00177">allInState()</a>, <a class="el" href="base_2trace_8hh_source.html#l00215">DPRINTF</a>, <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a8ea1e4c68c45720d9f01e3547de4c0f1">Drained</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a000c3dbb106309cf21ccf74967f39c4c">Draining</a>, <a class="el" href="logging_8hh_source.html#l00185">panic_if</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a69f55169cdb3caab27ba9f347bf05354">Resuming</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a5bda814c4aedb126839228f1a3d92f09">Running</a>, and <a class="el" href="logging_8hh_source.html#l00228">warn_if</a>.</p>

<p class="reference">Referenced by <a class="el" href="cxx__manager_8cc_source.html#l00633">CxxConfigManager::drainResume()</a>, and <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="abd134e8277be09e702b63f36f6ee31d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd134e8277be09e702b63f36f6ee31d0">&#9670;&nbsp;</a></span>signalDrainDone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DrainManager::signalDrainDone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Notify the <a class="el" href="classDrainManager.html" title="This class coordinates draining of a System. ">DrainManager</a> that a <a class="el" href="classDrainable.html" title="Interface for objects that might require draining before checkpointing. ">Drainable</a> object has finished draining. </p>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00148">148</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00179">_count</a>, <a class="el" href="base_2trace_8hh_source.html#l00215">DPRINTF</a>, <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, and <a class="el" href="sim__events_8cc_source.html#l00090">exitSimLoop()</a>.</p>

<p class="reference">Referenced by <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="a0faa0b57b1c33a16bd616c51a6ec24f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0faa0b57b1c33a16bd616c51a6ec24f9">&#9670;&nbsp;</a></span>state()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a> DrainManager::state </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the simulators global drain state. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00143">143</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00177">allInState()</a>, and <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="a8b3fc7aff27e4080eddcb5c31b5a508c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b3fc7aff27e4080eddcb5c31b5a508c">&#9670;&nbsp;</a></span>tryDrain()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DrainManager::tryDrain </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Try to drain the system. </p>
<p>Try to drain the system and return true if all objects are in a the Drained state at which point the whole simulator is in a consistent state and ready for checkpointing or CPU handover. The simulation script must continue simulating until the simulation loop returns "Finished drain", at which point this method should be called again. This cycle should continue until this method returns true.</p>
<dl class="section return"><dt>Returns</dt><dd>true if all objects were drained successfully, false if more simulation is needed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00063">63</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00179">_count</a>, <a class="el" href="drain_8hh_source.html#l00182">_state</a>, <a class="el" href="base_2trace_8hh_source.html#l00215">DPRINTF</a>, <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a8ea1e4c68c45720d9f01e3547de4c0f1">Drained</a>, <a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043a000c3dbb106309cf21ccf74967f39c4c">Draining</a>, <a class="el" href="base_2trace_8hh_source.html#l00213">DTRACE</a>, <a class="el" href="sim__object_8hh_source.html#l00120">SimObject::name()</a>, <a class="el" href="logging_8hh_source.html#l00185">panic_if</a>, and <a class="el" href="miscregs__types_8hh_source.html#l00396">ArmISA::status</a>.</p>

<p class="reference">Referenced by <a class="el" href="cxx__manager_8cc_source.html#l00627">CxxConfigManager::drain()</a>, and <a class="el" href="python_2pybind11_2core_8cc_source.html#l00100">init_drain()</a>.</p>

</div>
</div>
<a id="ad6b585f2ca6a932300c404d571eac704"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b585f2ca6a932300c404d571eac704">&#9670;&nbsp;</a></span>unregisterDrainable()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DrainManager::unregisterDrainable </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainable.html">Drainable</a> *&#160;</td>
          <td class="paramname"><em>obj</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="drain_8cc_source.html#l00168">168</a> of file <a class="el" href="drain_8cc_source.html">drain.cc</a>.</p>

<p class="reference">References <a class="el" href="drain_8hh_source.html#l00172">_allDrainable</a>, <a class="el" href="drain_8hh_source.html#l00169">globalLock</a>, and <a class="el" href="arch_2x86_2types_8hh_source.html#l00079">X86ISA::lock</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00203">Drainable::~Drainable()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aadac195f79f459b6c95e944518e389a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadac195f79f459b6c95e944518e389a7">&#9670;&nbsp;</a></span>_allDrainable</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classDrainable.html">Drainable</a> *&gt; DrainManager::_allDrainable</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="classSet.html">Set</a> of all drainable objects. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00172">172</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00177">allInState()</a>, <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, <a class="el" href="drain_8cc_source.html#l00134">preCheckpointRestore()</a>, <a class="el" href="drain_8cc_source.html#l00159">registerDrainable()</a>, <a class="el" href="drain_8cc_source.html#l00095">resume()</a>, <a class="el" href="drain_8cc_source.html#l00063">tryDrain()</a>, and <a class="el" href="drain_8cc_source.html#l00168">unregisterDrainable()</a>.</p>

</div>
</div>
<a id="a57aef09499f30e61d2afb51ea3b45235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57aef09499f30e61d2afb51ea3b45235">&#9670;&nbsp;</a></span>_count</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::atomic_uint DrainManager::_count</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Number of objects still draining. </p>
<p>This is flagged atomic since it can be manipulated by SimObjects living in different threads. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00179">179</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00095">resume()</a>, <a class="el" href="drain_8cc_source.html#l00148">signalDrainDone()</a>, and <a class="el" href="drain_8cc_source.html#l00063">tryDrain()</a>.</p>

</div>
</div>
<a id="aad46539173c793271c8c305f30f15c54"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad46539173c793271c8c305f30f15c54">&#9670;&nbsp;</a></span>_instance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainManager.html">DrainManager</a> DrainManager::_instance</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Singleton instance of the drain manager. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00185">185</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

</div>
</div>
<a id="a03011ac517c977d4de2d9c968c6cd925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03011ac517c977d4de2d9c968c6cd925">&#9670;&nbsp;</a></span>_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="drain_8hh.html#ac9ed0d5c83a29cf8938316f174264043">DrainState</a> DrainManager::_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Global simulator drain state. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00182">182</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00134">preCheckpointRestore()</a>, <a class="el" href="drain_8cc_source.html#l00095">resume()</a>, and <a class="el" href="drain_8cc_source.html#l00063">tryDrain()</a>.</p>

</div>
</div>
<a id="ae7ad8cefcb557350ac7be5d7fd9ba405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ad8cefcb557350ac7be5d7fd9ba405">&#9670;&nbsp;</a></span>globalLock</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex DrainManager::globalLock</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Lock protecting the set of drainable objects. </p>

<p class="definition">Definition at line <a class="el" href="drain_8hh_source.html#l00169">169</a> of file <a class="el" href="drain_8hh_source.html">drain.hh</a>.</p>

<p class="reference">Referenced by <a class="el" href="drain_8cc_source.html#l00188">drainableCount()</a>, <a class="el" href="drain_8cc_source.html#l00159">registerDrainable()</a>, and <a class="el" href="drain_8cc_source.html#l00168">unregisterDrainable()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>sim/<a class="el" href="drain_8hh_source.html">drain.hh</a></li>
<li>sim/<a class="el" href="drain_8cc_source.html">drain.cc</a></li>
</ul>
</div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
Generated on Mon Nov 25 2019 12:52:16 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.8.13</small></address>
</body>
</html>
