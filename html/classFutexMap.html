<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gem5: FutexMap Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gem5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classFutexMap-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">FutexMap Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="classFutexMap.html" title="FutexMap class holds a map of all futexes used in the system. ">FutexMap</a> class holds a map of all futexes used in the system.  
 <a href="classFutexMap.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for FutexMap:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classFutexMap.png" usemap="#FutexMap_map" alt=""/>
  <map id="FutexMap_map" name="FutexMap_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3fdaa7e9f0e2da1e20889535a61cf693"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFutexMap.html#a3fdaa7e9f0e2da1e20889535a61cf693">suspend</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="inet_8hh.html#ae32b25ff633168fbdecd8d24293034cd">addr</a>, uint64_t tgid, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr class="memdesc:a3fdaa7e9f0e2da1e20889535a61cf693"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inserts a futex into the map with one waiting TC.  <a href="#a3fdaa7e9f0e2da1e20889535a61cf693">More...</a><br /></td></tr>
<tr class="separator:a3fdaa7e9f0e2da1e20889535a61cf693"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18932b4ebd7f0f7670129ad747c578aa"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFutexMap.html#a18932b4ebd7f0f7670129ad747c578aa">wakeup</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="inet_8hh.html#ae32b25ff633168fbdecd8d24293034cd">addr</a>, uint64_t tgid, int count)</td></tr>
<tr class="memdesc:a18932b4ebd7f0f7670129ad747c578aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes up at most count waiting threads on a futex.  <a href="#a18932b4ebd7f0f7670129ad747c578aa">More...</a><br /></td></tr>
<tr class="separator:a18932b4ebd7f0f7670129ad747c578aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c94ca3623db19e13c1aa440f126cced"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFutexMap.html#a1c94ca3623db19e13c1aa440f126cced">suspend_bitset</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="inet_8hh.html#ae32b25ff633168fbdecd8d24293034cd">addr</a>, uint64_t tgid, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, int bitmask)</td></tr>
<tr class="memdesc:a1c94ca3623db19e13c1aa440f126cced"><td class="mdescLeft">&#160;</td><td class="mdescRight">inserts a futex into the map with one waiting TC associates the waiter with a given bitmask  <a href="#a1c94ca3623db19e13c1aa440f126cced">More...</a><br /></td></tr>
<tr class="separator:a1c94ca3623db19e13c1aa440f126cced"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d8e6f796753b21dcc6f20bc55a909de"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFutexMap.html#a9d8e6f796753b21dcc6f20bc55a909de">wakeup_bitset</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="inet_8hh.html#ae32b25ff633168fbdecd8d24293034cd">addr</a>, uint64_t tgid, int bitmask)</td></tr>
<tr class="memdesc:a9d8e6f796753b21dcc6f20bc55a909de"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wakes up all waiters waiting on the addr and associated with the given bitset.  <a href="#a9d8e6f796753b21dcc6f20bc55a909de">More...</a><br /></td></tr>
<tr class="separator:a9d8e6f796753b21dcc6f20bc55a909de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06561f0e554f91373abccba558300a93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classFutexMap.html#a06561f0e554f91373abccba558300a93">requeue</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr1, uint64_t tgid, int count, int count2, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr2)</td></tr>
<tr class="memdesc:a06561f0e554f91373abccba558300a93"><td class="mdescLeft">&#160;</td><td class="mdescRight">This operation wakes a given number (val) of waiters.  <a href="#a06561f0e554f91373abccba558300a93">More...</a><br /></td></tr>
<tr class="separator:a06561f0e554f91373abccba558300a93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="classFutexMap.html" title="FutexMap class holds a map of all futexes used in the system. ">FutexMap</a> class holds a map of all futexes used in the system. </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00121">121</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a06561f0e554f91373abccba558300a93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06561f0e554f91373abccba558300a93">&#9670;&nbsp;</a></span>requeue()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FutexMap::requeue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This operation wakes a given number (val) of waiters. </p>
<p>If there are more threads waiting than woken, they are removed from the wait queue of the futex pointed to by addr1 and added to the wait queue of the futex pointed to by addr2. The number of waiter moved is capped by count2 (misused timeout parameter).</p>
<p>The return value is the number of waiters that are woken or requeued. </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00243">243</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>

<p class="reference">References <a class="el" href="arch_2x86_2regs_2misc_8hh_source.html#l00705">X86ISA::count</a>, <a class="el" href="miscregs__types_8hh_source.html#l00056">ArmISA::it1</a>, <a class="el" href="miscregs__types_8hh_source.html#l00062">ArmISA::it2</a>, and <a class="el" href="mips_2pra__constants_8hh_source.html#l00280">MipsISA::w</a>.</p>

<p class="reference">Referenced by <a class="el" href="syscall__emul_8hh_source.html#l00334">futexFunc()</a>.</p>

</div>
</div>
<a id="a3fdaa7e9f0e2da1e20889535a61cf693"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fdaa7e9f0e2da1e20889535a61cf693">&#9670;&nbsp;</a></span>suspend()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FutexMap::suspend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&#160;</td>
          <td class="paramname"><em>tc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Inserts a futex into the map with one waiting TC. </p>
<p>Suspend the thread context </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00126">126</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>

<p class="reference">References <a class="el" href="classThreadContext.html#aff686d13f0b068a7fad2e5b8cf62a99d">ThreadContext::suspend()</a>.</p>

<p class="reference">Referenced by <a class="el" href="syscall__emul_8hh_source.html#l00334">futexFunc()</a>.</p>

</div>
</div>
<a id="a1c94ca3623db19e13c1aa440f126cced"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c94ca3623db19e13c1aa440f126cced">&#9670;&nbsp;</a></span>suspend_bitset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void FutexMap::suspend_bitset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&#160;</td>
          <td class="paramname"><em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>inserts a futex into the map with one waiting TC associates the waiter with a given bitmask </p>
<p>Suspend the thread context </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00179">179</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>

<p class="reference">References <a class="el" href="classThreadContext.html#aff686d13f0b068a7fad2e5b8cf62a99d">ThreadContext::suspend()</a>.</p>

<p class="reference">Referenced by <a class="el" href="syscall__emul_8hh_source.html#l00334">futexFunc()</a>.</p>

</div>
</div>
<a id="a18932b4ebd7f0f7670129ad747c578aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a18932b4ebd7f0f7670129ad747c578aa">&#9670;&nbsp;</a></span>wakeup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FutexMap::wakeup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wakes up at most count waiting threads on a futex. </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00144">144</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>

<p class="reference">References <a class="el" href="arch_2x86_2regs_2misc_8hh_source.html#l00705">X86ISA::count</a>, and <a class="el" href="cpu_2thread__context_8hh_source.html#l00110">ThreadContext::Suspended</a>.</p>

<p class="reference">Referenced by <a class="el" href="syscall__emul_8cc_source.html#l00087">exitFutexWake()</a>, and <a class="el" href="syscall__emul_8hh_source.html#l00334">futexFunc()</a>.</p>

</div>
</div>
<a id="a9d8e6f796753b21dcc6f20bc55a909de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d8e6f796753b21dcc6f20bc55a909de">&#9670;&nbsp;</a></span>wakeup_bitset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int FutexMap::wakeup_bitset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>tgid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitmask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Wakes up all waiters waiting on the addr and associated with the given bitset. </p>

<p class="definition">Definition at line <a class="el" href="futex__map_8hh_source.html#l00201">201</a> of file <a class="el" href="futex__map_8hh_source.html">futex_map.hh</a>.</p>

<p class="reference">References <a class="el" href="classThreadContext.html#a6a55099a666cbd6711cf317acc0e3e80">ThreadContext::activate()</a>, <a class="el" href="futex__map_8hh_source.html#l00110">WaiterState::checkMask()</a>, and <a class="el" href="futex__map_8hh_source.html#l00088">WaiterState::tc</a>.</p>

<p class="reference">Referenced by <a class="el" href="syscall__emul_8hh_source.html#l00334">futexFunc()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>sim/<a class="el" href="futex__map_8hh_source.html">futex_map.hh</a></li>
</ul>
</div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
Generated on Mon Nov 25 2019 12:52:17 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.8.13</small></address>
</body>
</html>
