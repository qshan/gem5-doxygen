<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gem5: dev/net/tcp_iface.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gem5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5fc0168d11760b9445bd29fa15d9290f.html">dev</a></li><li class="navelem"><a class="el" href="dir_5573faef3cd08dc765dd39f4c8927d1a.html">net</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">tcp_iface.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="tcp__iface_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2015 ARM Limited</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * All rights reserved</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * The license below extends only to copyright in the software and shall</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * not be construed as granting a license to any other intellectual</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * property including but not limited to intellectual property relating</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * to a hardware implementation of the functionality of the software</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * licensed hereunder.  You may use the software subject to the license</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * terms below provided that you ensure that this notice is replicated</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * unmodified and in its entirety in all distributions of the software,</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * modified or unmodified, in source code or in binary form.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * modification, are permitted provided that the following conditions are</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * met: redistributions of source code must retain the above copyright</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * notice, this list of conditions and the following disclaimer;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * redistributions in binary form must reproduce the above copyright</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * notice, this list of conditions and the following disclaimer in the</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * documentation and/or other materials provided with the distribution;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * neither the name of the copyright holders nor the names of its</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * contributors may be used to endorse or promote products derived from</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * this software without specific prior written permission.</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * Authors: Gabor Dozsa</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> *          Mohammad Alian</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">/* @file</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * TCP stream socket based interface class implementation for dist-gem5 runs.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="tcp__iface_8hh.html">dev/net/tcp_iface.hh</a>&quot;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;netdb.h&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &lt;netinet/tcp.h&gt;</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &lt;cerrno&gt;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &lt;cstring&gt;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="base_2types_8hh.html">base/types.hh</a>&quot;</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;debug/DistEthernet.hh&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;debug/DistEthernetCmd.hh&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="sim__exit_8hh.html">sim/sim_exit.hh</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#if defined(__FreeBSD__)</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">// MSG_NOSIGNAL does not exists on OS X</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#if defined(__APPLE__) || defined(__MACH__)</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#ifndef MSG_NOSIGNAL</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#define MSG_NOSIGNAL SO_NOSIGPIPE</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<a class="code" href="classstd_1_1vector.html">std::vector&lt;std::pair&lt;TCPIface::NodeInfo, int&gt;</a> &gt; <a class="code" href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">TCPIface::nodes</a>;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<a class="code" href="classstd_1_1vector.html">vector&lt;int&gt;</a> <a class="code" href="classTCPIface.html#a2d818da98576e5786df79a8564bcc327">TCPIface::sockRegistry</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">int</span> <a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">TCPIface::fdStatic</a> = -1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classTCPIface.html#a001b48c35c39be030be2def63153550c">TCPIface::anyListening</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classTCPIface.html#a21b429b595de4119deb4fcbfd86aec7a">   82</a></span>&#160;<a class="code" href="classTCPIface.html#a21b429b595de4119deb4fcbfd86aec7a">TCPIface::TCPIface</a>(<span class="keywordtype">string</span> server_name, <span class="keywordtype">unsigned</span> server_port,</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                   <span class="keywordtype">unsigned</span> dist_rank, <span class="keywordtype">unsigned</span> dist_size,</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                   <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> sync_start, <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> sync_repeat,</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                   <a class="code" href="classEventManager.html">EventManager</a> *<a class="code" href="namespaceX86ISA.html#a9c198fbee44f4233f22501e7b55eee5d">em</a>, <span class="keywordtype">bool</span> use_pseudo_op, <span class="keywordtype">bool</span> is_switch,</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                   <span class="keywordtype">int</span> num_nodes) :</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classDistIface.html">DistIface</a>(dist_rank, dist_size, sync_start, sync_repeat, em, use_pseudo_op,</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;              is_switch, num_nodes), serverName(server_name),</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    serverPort(server_port), isSwitch(is_switch), listening(false)</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;{</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">if</span> (is_switch &amp;&amp; <a class="code" href="classDistIface.html#a687a154f55033e6318fbc249a2d996e6">isMaster</a>) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">while</span> (!<a class="code" href="classTCPIface.html#aee28ec6e04eb5883a4b4297a00472ef2">listen</a>(<a class="code" href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">serverPort</a>)) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernet, <span class="stringliteral">&quot;TCPIface(listen): Can&#39;t bind port %d\n&quot;</span>,</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    <a class="code" href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">serverPort</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">serverPort</a>++;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <a class="code" href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;tcp_iface listening on port %d&quot;</span>, <a class="code" href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">serverPort</a>);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// Now accept the first connection requests from each compute node and</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// store the node info. The compute nodes will then wait for ack</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="comment">// messages. Ack messages will be sent by initTransport() in the</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// appropriate order to make sure that every compute node is always</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// connected to the same switch port.</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="structTCPIface_1_1NodeInfo.html">NodeInfo</a> <a class="code" href="namespacePowerISA.html#aebceacd450396814cf9033e707b21655">ni</a>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#a07402644ed55c19e1a116116c548c2ac">i</a> = 0; <a class="code" href="namespaceArmISA.html#a07402644ed55c19e1a116116c548c2ac">i</a> &lt; <a class="code" href="classDistIface.html#aafa11eb3c3d2a81027f800efc64fbbac">size</a>; <a class="code" href="namespaceArmISA.html#a07402644ed55c19e1a116116c548c2ac">i</a>++) {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;            <a class="code" href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">accept</a>();</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernet, <span class="stringliteral">&quot;First connection, waiting for link info\n&quot;</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">recvTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;ni, <span class="keyword">sizeof</span>(ni)))</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Failed to receive link info&quot;</span>);</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <a class="code" href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">nodes</a>.push_back(make_pair(ni, <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>));</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        }</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="classTCPIface.html#aee28ec6e04eb5883a4b4297a00472ef2">  115</a></span>&#160;<a class="code" href="classTCPIface.html#aee28ec6e04eb5883a4b4297a00472ef2">TCPIface::listen</a>(<span class="keywordtype">int</span> port)</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classTCPIface.html#a943d07cbe21382bfaef42a1c13e1801f">listening</a>)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Socket already listening!&quot;</span>);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keyword">struct </span>sockaddr_in sockaddr;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">fdStatic</a> = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(<a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">fdStatic</a> &lt; 0, <span class="stringliteral">&quot;socket() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    sockaddr.sin_family = PF_INET;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    sockaddr.sin_addr.s_addr = INADDR_ANY;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    sockaddr.sin_port = htons(port);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// finally clear sin_zero</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    memset(&amp;sockaddr.sin_zero, 0, <span class="keyword">sizeof</span>(sockaddr.sin_zero));</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    ret = ::bind(<a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">fdStatic</a>, (<span class="keyword">struct</span> sockaddr *)&amp;sockaddr, <span class="keyword">sizeof</span> (sockaddr));</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span> (ret != 0) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">if</span> (ret == -1 &amp;&amp; errno != EADDRINUSE)</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;ListenSocket(listen): bind() failed!&quot;</span>);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (::<a class="code" href="classTCPIface.html#aee28ec6e04eb5883a4b4297a00472ef2">listen</a>(<a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">fdStatic</a>, 24) == -1) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span> (errno != EADDRINUSE)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;ListenSocket(listen): listen() failed!&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classTCPIface.html#a943d07cbe21382bfaef42a1c13e1801f">listening</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="classTCPIface.html#a001b48c35c39be030be2def63153550c">anyListening</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;}</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="classTCPIface.html#a1cb9fd381c332c3b64307857afa91336">  152</a></span>&#160;<a class="code" href="classTCPIface.html#a1cb9fd381c332c3b64307857afa91336">TCPIface::establishConnection</a>()</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> cur_rank = 0;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">unsigned</span> cur_id = 0;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="structTCPIface_1_1NodeInfo.html">NodeInfo</a> <a class="code" href="namespacePowerISA.html#aebceacd450396814cf9033e707b21655">ni</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classTCPIface.html#a3a6d85da08a7df9dc5ad04a94b975508">isSwitch</a>) {</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (cur_id == 0) { <span class="comment">// first connection accepted in the ctor already</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keyword">auto</span> <span class="keyword">const</span> &amp;iface0 =</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                find_if(<a class="code" href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">nodes</a>.begin(), <a class="code" href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">nodes</a>.end(),</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                        [](<span class="keyword">const</span> <a class="code" href="classstd_1_1pair.html">pair&lt;NodeInfo, int&gt;</a> &amp;cn) -&gt; <span class="keywordtype">bool</span> {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                            <span class="keywordflow">return</span> cn.first.rank == cur_rank;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                        });</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            assert(iface0 != <a class="code" href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">nodes</a>.end());</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            assert(iface0-&gt;first.distIfaceId == 0);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a> = iface0-&gt;second;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            ni = iface0-&gt;first;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        } <span class="keywordflow">else</span> { <span class="comment">// additional connections from the same compute node</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">accept</a>();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernet, <span class="stringliteral">&quot;Next connection, waiting for link info\n&quot;</span>);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">recvTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;ni, <span class="keyword">sizeof</span>(ni)))</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Failed to receive link info&quot;</span>);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            assert(ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a99614336936300dd80868a05b9a66b36">rank</a> == cur_rank);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            assert(ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a> == cur_id);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <a class="code" href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;Link okay  (iface:%d -&gt; (node:%d, iface:%d))&quot;</span>,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;               <a class="code" href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">distIfaceId</a>, ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a99614336936300dd80868a05b9a66b36">rank</a>, ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a>);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordflow">if</span> (ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a> &lt; ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a0c6b390d266e01a7311c2168bb514b57">distIfaceNum</a> - 1) {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            cur_id++;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            cur_rank++;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            cur_id = 0;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// send ack</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a> = <a class="code" href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">distIfaceId</a>;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a0c6b390d266e01a7311c2168bb514b57">distIfaceNum</a> = <a class="code" href="classDistIface.html#ab6f1e2c0fac4506f5366c36200eacf98">distIfaceNum</a>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">sendTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;ni, <span class="keyword">sizeof</span>(ni));</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// this is not a switch</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <a class="code" href="classTCPIface.html#aced8ab108b3ed2505dedd4c2ca183f6e">connect</a>();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// send link info</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a99614336936300dd80868a05b9a66b36">rank</a> = <a class="code" href="classDistIface.html#a0e42826c555d71f76cb62c73db871c7d">rank</a>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a> = <a class="code" href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">distIfaceId</a>;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a0c6b390d266e01a7311c2168bb514b57">distIfaceNum</a> = <a class="code" href="classDistIface.html#ab6f1e2c0fac4506f5366c36200eacf98">distIfaceNum</a>;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">sendTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;ni, <span class="keyword">sizeof</span>(ni));</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernet, <span class="stringliteral">&quot;Connected, waiting for ack (distIfaceId:%d\n&quot;</span>,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <a class="code" href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">distIfaceId</a>);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">recvTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;ni, <span class="keyword">sizeof</span>(ni)))</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Failed to receive ack&quot;</span>);</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        assert(ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#a99614336936300dd80868a05b9a66b36">rank</a> == <a class="code" href="classDistIface.html#a0e42826c555d71f76cb62c73db871c7d">rank</a>);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;Link okay  (iface:%d -&gt; switch iface:%d)&quot;</span>, <a class="code" href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">distIfaceId</a>,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;               ni.<a class="code" href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">distIfaceId</a>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="classTCPIface.html#a2d818da98576e5786df79a8564bcc327">sockRegistry</a>.push_back(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">  208</a></span>&#160;<a class="code" href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">TCPIface::accept</a>()</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;{</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">struct </span>sockaddr_in sockaddr;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    socklen_t slen = <span class="keyword">sizeof</span> (sockaddr);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a> = <a class="code" href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">::accept</a>(<a class="code" href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">fdStatic</a>, (<span class="keyword">struct</span> sockaddr *)&amp;sockaddr, &amp;slen);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a> != -1) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#a07402644ed55c19e1a116116c548c2ac">i</a> = 1;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (setsockopt(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, IPPROTO_TCP, TCP_NODELAY, (<span class="keywordtype">char</span> *)&amp;i,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                         <span class="keyword">sizeof</span>(i)) &lt; 0)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <a class="code" href="logging_8hh.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;ListenSocket(accept): setsockopt() TCP_NODELAY failed!&quot;</span>);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classTCPIface.html#aced8ab108b3ed2505dedd4c2ca183f6e">  222</a></span>&#160;<a class="code" href="classTCPIface.html#aced8ab108b3ed2505dedd4c2ca183f6e">TCPIface::connect</a>()</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keyword">struct </span>addrinfo addr_hint, *addr_results;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;     <span class="keywordtype">int</span> ret;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     <span class="keywordtype">string</span> port_str = <a class="code" href="namespacesc__dt.html#acfe1beffdda4afa09e04790b737f4aab">to_string</a>(<a class="code" href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">serverPort</a>);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;     <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a> = socket(PF_INET, SOCK_STREAM, IPPROTO_TCP);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a> &lt; 0, <span class="stringliteral">&quot;socket() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;     <span class="keywordtype">int</span> fl = 1;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;     <span class="keywordflow">if</span> (setsockopt(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, IPPROTO_TCP, TCP_NODELAY, (<span class="keywordtype">char</span> *)&amp;fl, <span class="keyword">sizeof</span>(fl)) &lt; 0)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <a class="code" href="logging_8hh.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;ConnectSocket(connect): setsockopt() TCP_NODELAY failed!&quot;</span>);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;     bzero(&amp;addr_hint, <span class="keyword">sizeof</span>(addr_hint));</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;     addr_hint.ai_family = AF_INET;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;     addr_hint.ai_socktype = SOCK_STREAM;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     addr_hint.ai_protocol = IPPROTO_TCP;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;     ret = getaddrinfo(<a class="code" href="classTCPIface.html#a8b3a4eee85e5e0fd6fb0e25b900d5d89">serverName</a>.c_str(), port_str.c_str(),</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                       &amp;addr_hint, &amp;addr_results);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;     <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(ret &lt; 0, <span class="stringliteral">&quot;getaddrinf() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;     <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernet, <span class="stringliteral">&quot;Connecting to %s:%s\n&quot;</span>,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;             <a class="code" href="classTCPIface.html#a8b3a4eee85e5e0fd6fb0e25b900d5d89">serverName</a>.c_str(), port_str.c_str());</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;     ret = <a class="code" href="classTCPIface.html#aced8ab108b3ed2505dedd4c2ca183f6e">::connect</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, (<span class="keyword">struct</span> sockaddr *)(addr_results-&gt;ai_addr),</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                     addr_results-&gt;ai_addrlen);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;     <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(ret &lt; 0, <span class="stringliteral">&quot;connect() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;     freeaddrinfo(addr_results);</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;}</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classTCPIface.html#abdd0b951de9a25952ba4cdeadf9f50ae">  255</a></span>&#160;<a class="code" href="classTCPIface.html#abdd0b951de9a25952ba4cdeadf9f50ae">TCPIface::~TCPIface</a>()</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;{</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="arch_2x86_2process_8cc.html#a4a522b8848c4afad8c6404708a44a05f">M5_VAR_USED</a> ret;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ret = close(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    assert(ret == 0);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;}</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">  264</a></span>&#160;<a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">TCPIface::sendTCP</a>(<span class="keywordtype">int</span> <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, <span class="keyword">const</span> <span class="keywordtype">void</span> *buf, <span class="keywordtype">unsigned</span> <a class="code" href="inet_8hh.html#ab2b3adeb2a67e656ff030b56727fd0ac">length</a>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    ssize_t ret;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    ret = ::send(sock, buf, length, MSG_NOSIGNAL);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keywordflow">if</span> (errno == ECONNRESET || errno == EPIPE) {</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <a class="code" href="sim__events_8cc.html#abca976500ad365c77607ab77d87698a7">exitSimLoop</a>(<span class="stringliteral">&quot;Message server closed connection, simulation &quot;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                        <span class="stringliteral">&quot;is exiting&quot;</span>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;send() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(ret != length, <span class="stringliteral">&quot;send() failed&quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;}</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">  281</a></span>&#160;<a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">TCPIface::recvTCP</a>(<span class="keywordtype">int</span> <a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, <span class="keywordtype">void</span> *buf, <span class="keywordtype">unsigned</span> <a class="code" href="inet_8hh.html#ab2b3adeb2a67e656ff030b56727fd0ac">length</a>)</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;{</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    ssize_t ret;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    ret = ::recv(sock, buf, length,  MSG_WAITALL );</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">if</span> (ret &lt; 0) {</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">if</span> (errno == ECONNRESET || errno == EPIPE)</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;recv(): %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret &lt; 0)</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;recv() failed: %s&quot;</span>, strerror(errno));</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 0) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;recv(): Connection closed&quot;</span>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret != length)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <a class="code" href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;recv() failed&quot;</span>);</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">return</span> (ret == length);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="classTCPIface.html#a95f9efd9f1229dd04860b5dd36d0f27a">  300</a></span>&#160;<a class="code" href="classTCPIface.html#a95f9efd9f1229dd04860b5dd36d0f27a">TCPIface::sendPacket</a>(<span class="keyword">const</span> <a class="code" href="structDistHeaderPkt_1_1Header.html">Header</a> &amp;<a class="code" href="nop_8cc.html#a610d5ccd0b17d01574eb9ec1d91d5bda">header</a>, <span class="keyword">const</span> <a class="code" href="etherpkt_8hh.html#a7da8331ad4f14fefeae9a3f2404ea734">EthPacketPtr</a> &amp;packet)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;{</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">sendTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;header, <span class="keyword">sizeof</span>(header));</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">sendTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, packet-&gt;data, packet-&gt;length);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;}</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classTCPIface.html#a69d7671884a449b8671cd02419ebd1a8">  307</a></span>&#160;<a class="code" href="classTCPIface.html#a69d7671884a449b8671cd02419ebd1a8">TCPIface::sendCmd</a>(<span class="keyword">const</span> <a class="code" href="structDistHeaderPkt_1_1Header.html">Header</a> &amp;<a class="code" href="nop_8cc.html#a610d5ccd0b17d01574eb9ec1d91d5bda">header</a>)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;{</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernetCmd, <span class="stringliteral">&quot;TCPIface::sendCmd() type: %d\n&quot;</span>,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            static_cast&lt;int&gt;(header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a7207eb637c28a3d9e18251671182a904">msgType</a>));</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Global commands (i.e. sync request) are always sent by the master</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// DistIface. The transfer method is simply implemented as point-to-point</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// messages for now</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#ae32c8ef7b61b7855b3a47485974d0e2f">s</a>: <a class="code" href="classTCPIface.html#a2d818da98576e5786df79a8564bcc327">sockRegistry</a>)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <a class="code" href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">sendTCP</a>(<a class="code" href="namespaceArmISA.html#ae32c8ef7b61b7855b3a47485974d0e2f">s</a>, (<span class="keywordtype">void</span>*)&amp;header, <span class="keyword">sizeof</span>(header));</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classTCPIface.html#a7d9e6d6ffc8cef2a9f15e9dd41c31552">  319</a></span>&#160;<a class="code" href="classTCPIface.html#a7d9e6d6ffc8cef2a9f15e9dd41c31552">TCPIface::recvHeader</a>(<a class="code" href="structDistHeaderPkt_1_1Header.html">Header</a> &amp;<a class="code" href="nop_8cc.html#a610d5ccd0b17d01574eb9ec1d91d5bda">header</a>)</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;{</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">bool</span> ret = <a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">recvTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, &amp;header, <span class="keyword">sizeof</span>(header));</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DistEthernetCmd, <span class="stringliteral">&quot;TCPIface::recvHeader() type: %d ret: %d\n&quot;</span>,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;            static_cast&lt;int&gt;(header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a7207eb637c28a3d9e18251671182a904">msgType</a>), ret);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classTCPIface.html#a2bc6c5ae5e29945bd629290df7702229">  328</a></span>&#160;<a class="code" href="classTCPIface.html#a2bc6c5ae5e29945bd629290df7702229">TCPIface::recvPacket</a>(<span class="keyword">const</span> <a class="code" href="structDistHeaderPkt_1_1Header.html">Header</a> &amp;<a class="code" href="nop_8cc.html#a610d5ccd0b17d01574eb9ec1d91d5bda">header</a>, <a class="code" href="etherpkt_8hh.html#a7da8331ad4f14fefeae9a3f2404ea734">EthPacketPtr</a> &amp;packet)</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;{</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    packet = make_shared&lt;EthPacketData&gt;(header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a2edef5ff7177f7305bccb3c04ff05f19">dataPacketLength</a>);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">bool</span> ret = <a class="code" href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">recvTCP</a>(<a class="code" href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">sock</a>, packet-&gt;data, header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a2edef5ff7177f7305bccb3c04ff05f19">dataPacketLength</a>);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a>(!ret, <span class="stringliteral">&quot;Error while reading socket&quot;</span>);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    packet-&gt;simLength = header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a692573450883b3759e885ff1d920a813">simLength</a>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    packet-&gt;length = header.<a class="code" href="structDistHeaderPkt_1_1Header.html#a2edef5ff7177f7305bccb3c04ff05f19">dataPacketLength</a>;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;}</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00338"></a><span class="lineno"><a class="line" href="classTCPIface.html#a1f8f4e6b8e90c8a151d60eaf8a3ece12">  338</a></span>&#160;<a class="code" href="classTCPIface.html#a1f8f4e6b8e90c8a151d60eaf8a3ece12">TCPIface::initTransport</a>()</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;{</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// We cannot setup the conections in the constructor because the number</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// of dist interfaces (per process) is unknown until the (simobject) init</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// phase. That information is necessary for global connection ordering.</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="classTCPIface.html#a1cb9fd381c332c3b64307857afa91336">establishConnection</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div><div class="ttc" id="logging_8hh_html_a1445e207e36c97ff84c54b47288cea19"><div class="ttname"><a href="logging_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a></div><div class="ttdeci">#define panic(...)</div><div class="ttdoc">This implements a cprintf based panic() function. </div><div class="ttdef"><b>Definition:</b> <a href="logging_8hh_source.html#l00167">logging.hh:167</a></div></div>
<div class="ttc" id="base_2trace_8hh_html_aefe58fddf89e41edd783bf4c3e31d2c3"><div class="ttname"><a href="base_2trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a></div><div class="ttdeci">#define DPRINTF(x,...)</div><div class="ttdef"><b>Definition:</b> <a href="base_2trace_8hh_source.html#l00215">trace.hh:215</a></div></div>
<div class="ttc" id="classTCPIface_html_a8b3a4eee85e5e0fd6fb0e25b900d5d89"><div class="ttname"><a href="classTCPIface.html#a8b3a4eee85e5e0fd6fb0e25b900d5d89">TCPIface::serverName</a></div><div class="ttdeci">std::string serverName</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00070">tcp_iface.hh:70</a></div></div>
<div class="ttc" id="nop_8cc_html_a610d5ccd0b17d01574eb9ec1d91d5bda"><div class="ttname"><a href="nop_8cc.html#a610d5ccd0b17d01574eb9ec1d91d5bda">header</a></div><div class="ttdeci">output header</div><div class="ttdef"><b>Definition:</b> <a href="nop_8cc_source.html#l00039">nop.cc:39</a></div></div>
<div class="ttc" id="structDistHeaderPkt_1_1Header_html_a692573450883b3759e885ff1d920a813"><div class="ttname"><a href="structDistHeaderPkt_1_1Header.html#a692573450883b3759e885ff1d920a813">DistHeaderPkt::Header::simLength</a></div><div class="ttdeci">unsigned simLength</div><div class="ttdoc">Length used for modeling timing in the simulator. </div><div class="ttdef"><b>Definition:</b> <a href="dist__packet_8hh_source.html#l00093">dist_packet.hh:93</a></div></div>
<div class="ttc" id="structTCPIface_1_1NodeInfo_html_a99614336936300dd80868a05b9a66b36"><div class="ttname"><a href="structTCPIface_1_1NodeInfo.html#a99614336936300dd80868a05b9a66b36">TCPIface::NodeInfo::rank</a></div><div class="ttdeci">unsigned rank</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00085">tcp_iface.hh:85</a></div></div>
<div class="ttc" id="namespaceArmISA_html_a07402644ed55c19e1a116116c548c2ac"><div class="ttname"><a href="namespaceArmISA.html#a07402644ed55c19e1a116116c548c2ac">ArmISA::i</a></div><div class="ttdeci">Bitfield&lt; 7 &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="miscregs__types_8hh_source.html#l00066">miscregs_types.hh:66</a></div></div>
<div class="ttc" id="classstd_1_1pair_html"><div class="ttname"><a href="classstd_1_1pair.html">std::pair</a></div><div class="ttdoc">STL pair class. </div><div class="ttdef"><b>Definition:</b> <a href="stl_8hh_source.html#l00061">stl.hh:61</a></div></div>
<div class="ttc" id="classTCPIface_html_a3a6d85da08a7df9dc5ad04a94b975508"><div class="ttname"><a href="classTCPIface.html#a3a6d85da08a7df9dc5ad04a94b975508">TCPIface::isSwitch</a></div><div class="ttdeci">bool isSwitch</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00073">tcp_iface.hh:73</a></div></div>
<div class="ttc" id="namespaceX86ISA_html_a9c198fbee44f4233f22501e7b55eee5d"><div class="ttname"><a href="namespaceX86ISA.html#a9c198fbee44f4233f22501e7b55eee5d">X86ISA::em</a></div><div class="ttdeci">Bitfield&lt; 2 &gt; em</div><div class="ttdef"><b>Definition:</b> <a href="arch_2x86_2regs_2misc_8hh_source.html#l00604">misc.hh:604</a></div></div>
<div class="ttc" id="classTCPIface_html_a1f8f4e6b8e90c8a151d60eaf8a3ece12"><div class="ttname"><a href="classTCPIface.html#a1f8f4e6b8e90c8a151d60eaf8a3ece12">TCPIface::initTransport</a></div><div class="ttdeci">void initTransport() override</div><div class="ttdoc">Init hook for the underlaying transport. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00338">tcp_iface.cc:338</a></div></div>
<div class="ttc" id="classTCPIface_html_a69d7671884a449b8671cd02419ebd1a8"><div class="ttname"><a href="classTCPIface.html#a69d7671884a449b8671cd02419ebd1a8">TCPIface::sendCmd</a></div><div class="ttdeci">void sendCmd(const Header &amp;header) override</div><div class="ttdoc">Send out a control command to the remote end. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00307">tcp_iface.cc:307</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">Overload hash function for BasicBlockRange type. </div><div class="ttdef"><b>Definition:</b> <a href="vec__reg_8hh_source.html#l00585">vec_reg.hh:585</a></div></div>
<div class="ttc" id="classTCPIface_html_a001b48c35c39be030be2def63153550c"><div class="ttname"><a href="classTCPIface.html#a001b48c35c39be030be2def63153550c">TCPIface::anyListening</a></div><div class="ttdeci">static bool anyListening</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00076">tcp_iface.hh:76</a></div></div>
<div class="ttc" id="classstd_1_1vector_html"><div class="ttname"><a href="classstd_1_1vector.html">std::vector</a></div><div class="ttdoc">STL vector class. </div><div class="ttdef"><b>Definition:</b> <a href="stl_8hh_source.html#l00040">stl.hh:40</a></div></div>
<div class="ttc" id="structDistHeaderPkt_1_1Header_html_a7207eb637c28a3d9e18251671182a904"><div class="ttname"><a href="structDistHeaderPkt_1_1Header.html#a7207eb637c28a3d9e18251671182a904">DistHeaderPkt::Header::msgType</a></div><div class="ttdeci">MsgType msgType</div><div class="ttdoc">The msg type field is valid for all header packets. </div><div class="ttdef"><b>Definition:</b> <a href="dist__packet_8hh_source.html#l00087">dist_packet.hh:87</a></div></div>
<div class="ttc" id="classTCPIface_html_a943d07cbe21382bfaef42a1c13e1801f"><div class="ttname"><a href="classTCPIface.html#a943d07cbe21382bfaef42a1c13e1801f">TCPIface::listening</a></div><div class="ttdeci">bool listening</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00075">tcp_iface.hh:75</a></div></div>
<div class="ttc" id="logging_8hh_html_ae7d790080fa18103d7582effff570b9e"><div class="ttname"><a href="logging_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a></div><div class="ttdeci">#define inform(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8hh_source.html#l00213">logging.hh:213</a></div></div>
<div class="ttc" id="classTCPIface_html_abdd0b951de9a25952ba4cdeadf9f50ae"><div class="ttname"><a href="classTCPIface.html#abdd0b951de9a25952ba4cdeadf9f50ae">TCPIface::~TCPIface</a></div><div class="ttdeci">~TCPIface() override</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00255">tcp_iface.cc:255</a></div></div>
<div class="ttc" id="namespaceArmISA_html_ae32c8ef7b61b7855b3a47485974d0e2f"><div class="ttname"><a href="namespaceArmISA.html#ae32c8ef7b61b7855b3a47485974d0e2f">ArmISA::s</a></div><div class="ttdeci">Bitfield&lt; 4 &gt; s</div><div class="ttdef"><b>Definition:</b> <a href="miscregs__types_8hh_source.html#l00532">miscregs_types.hh:532</a></div></div>
<div class="ttc" id="classTCPIface_html_a21b429b595de4119deb4fcbfd86aec7a"><div class="ttname"><a href="classTCPIface.html#a21b429b595de4119deb4fcbfd86aec7a">TCPIface::TCPIface</a></div><div class="ttdeci">TCPIface(std::string server_name, unsigned server_port, unsigned dist_rank, unsigned dist_size, Tick sync_start, Tick sync_repeat, EventManager *em, bool use_pseudo_op, bool is_switch, int num_nodes)</div><div class="ttdoc">The ctor creates and connects the stream socket to the server. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00082">tcp_iface.cc:82</a></div></div>
<div class="ttc" id="base_2types_8hh_html_a5c8ed81b7d238c9083e1037ba6d61643"><div class="ttname"><a href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a></div><div class="ttdeci">uint64_t Tick</div><div class="ttdoc">Tick count type. </div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8hh_source.html#l00063">types.hh:63</a></div></div>
<div class="ttc" id="classTCPIface_html_addd40175f1b3435c32492bae81f05a31"><div class="ttname"><a href="classTCPIface.html#addd40175f1b3435c32492bae81f05a31">TCPIface::fdStatic</a></div><div class="ttdeci">static int fdStatic</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00077">tcp_iface.hh:77</a></div></div>
<div class="ttc" id="etherpkt_8hh_html_a7da8331ad4f14fefeae9a3f2404ea734"><div class="ttname"><a href="etherpkt_8hh.html#a7da8331ad4f14fefeae9a3f2404ea734">EthPacketPtr</a></div><div class="ttdeci">std::shared_ptr&lt; EthPacketData &gt; EthPacketPtr</div><div class="ttdef"><b>Definition:</b> <a href="etherpkt_8hh_source.html#l00090">etherpkt.hh:90</a></div></div>
<div class="ttc" id="sim__exit_8hh_html"><div class="ttname"><a href="sim__exit_8hh.html">sim_exit.hh</a></div></div>
<div class="ttc" id="classTCPIface_html_a2bc6c5ae5e29945bd629290df7702229"><div class="ttname"><a href="classTCPIface.html#a2bc6c5ae5e29945bd629290df7702229">TCPIface::recvPacket</a></div><div class="ttdeci">void recvPacket(const Header &amp;header, EthPacketPtr &amp;packet) override</div><div class="ttdoc">Receive a packet from the remote end. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00328">tcp_iface.cc:328</a></div></div>
<div class="ttc" id="classTCPIface_html_ae04abcfceeeee15a7aebbd5a3c439a22"><div class="ttname"><a href="classTCPIface.html#ae04abcfceeeee15a7aebbd5a3c439a22">TCPIface::sendTCP</a></div><div class="ttdeci">void sendTCP(int sock, const void *buf, unsigned length)</div><div class="ttdoc">Send out a message through a TCP stream socket. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00264">tcp_iface.cc:264</a></div></div>
<div class="ttc" id="base_2types_8hh_html"><div class="ttname"><a href="base_2types_8hh.html">types.hh</a></div><div class="ttdoc">Defines global host-dependent types: Counter, Tick, and (indirectly) {int,uint}{8,16,32,64}_t. </div></div>
<div class="ttc" id="classTCPIface_html_aced8ab108b3ed2505dedd4c2ca183f6e"><div class="ttname"><a href="classTCPIface.html#aced8ab108b3ed2505dedd4c2ca183f6e">TCPIface::connect</a></div><div class="ttdeci">void connect()</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00222">tcp_iface.cc:222</a></div></div>
<div class="ttc" id="classTCPIface_html_a2d818da98576e5786df79a8564bcc327"><div class="ttname"><a href="classTCPIface.html#a2d818da98576e5786df79a8564bcc327">TCPIface::sockRegistry</a></div><div class="ttdeci">static std::vector&lt; int &gt; sockRegistry</div><div class="ttdoc">Storage for all opened sockets. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00093">tcp_iface.hh:93</a></div></div>
<div class="ttc" id="classTCPIface_html_aee28ec6e04eb5883a4b4297a00472ef2"><div class="ttname"><a href="classTCPIface.html#aee28ec6e04eb5883a4b4297a00472ef2">TCPIface::listen</a></div><div class="ttdeci">bool listen(int port)</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00115">tcp_iface.cc:115</a></div></div>
<div class="ttc" id="classTCPIface_html_a1cb9fd381c332c3b64307857afa91336"><div class="ttname"><a href="classTCPIface.html#a1cb9fd381c332c3b64307857afa91336">TCPIface::establishConnection</a></div><div class="ttdeci">void establishConnection()</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00152">tcp_iface.cc:152</a></div></div>
<div class="ttc" id="classDistIface_html_aafa11eb3c3d2a81027f800efc64fbbac"><div class="ttname"><a href="classDistIface.html#aafa11eb3c3d2a81027f800efc64fbbac">DistIface::size</a></div><div class="ttdeci">unsigned size</div><div class="ttdoc">The number of gem5 processes comprising this dist simulation. </div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00486">dist_iface.hh:486</a></div></div>
<div class="ttc" id="classTCPIface_html_ade4dbec830cc05964413c65a602c4cf4"><div class="ttname"><a href="classTCPIface.html#ade4dbec830cc05964413c65a602c4cf4">TCPIface::recvTCP</a></div><div class="ttdeci">bool recvTCP(int sock, void *buf, unsigned length)</div><div class="ttdoc">Receive the next incoming message through a TCP stream socket. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00281">tcp_iface.cc:281</a></div></div>
<div class="ttc" id="classTCPIface_html_a7d9e6d6ffc8cef2a9f15e9dd41c31552"><div class="ttname"><a href="classTCPIface.html#a7d9e6d6ffc8cef2a9f15e9dd41c31552">TCPIface::recvHeader</a></div><div class="ttdeci">bool recvHeader(Header &amp;header) override</div><div class="ttdoc">Receive a header (i.e. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00319">tcp_iface.cc:319</a></div></div>
<div class="ttc" id="classDistIface_html_a687a154f55033e6318fbc249a2d996e6"><div class="ttname"><a href="classDistIface.html#a687a154f55033e6318fbc249a2d996e6">DistIface::isMaster</a></div><div class="ttdeci">bool isMaster</div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00496">dist_iface.hh:496</a></div></div>
<div class="ttc" id="structDistHeaderPkt_1_1Header_html"><div class="ttname"><a href="structDistHeaderPkt_1_1Header.html">DistHeaderPkt::Header</a></div><div class="ttdef"><b>Definition:</b> <a href="dist__packet_8hh_source.html#l00079">dist_packet.hh:79</a></div></div>
<div class="ttc" id="namespacePowerISA_html_aebceacd450396814cf9033e707b21655"><div class="ttname"><a href="namespacePowerISA.html#aebceacd450396814cf9033e707b21655">PowerISA::ni</a></div><div class="ttdeci">Bitfield&lt; 3 &gt; ni</div><div class="ttdef"><b>Definition:</b> <a href="power_2miscregs_8hh_source.html#l00094">miscregs.hh:94</a></div></div>
<div class="ttc" id="sim__events_8cc_html_abca976500ad365c77607ab77d87698a7"><div class="ttname"><a href="sim__events_8cc.html#abca976500ad365c77607ab77d87698a7">exitSimLoop</a></div><div class="ttdeci">void exitSimLoop(const std::string &amp;message, int exit_code, Tick when, Tick repeat, bool serialize)</div><div class="ttdoc">Schedule an event to exit the simulation loop (returning to Python) at the end of the current cycle (...</div><div class="ttdef"><b>Definition:</b> <a href="sim__events_8cc_source.html#l00090">sim_events.cc:90</a></div></div>
<div class="ttc" id="structDistHeaderPkt_1_1Header_html_a2edef5ff7177f7305bccb3c04ff05f19"><div class="ttname"><a href="structDistHeaderPkt_1_1Header.html#a2edef5ff7177f7305bccb3c04ff05f19">DistHeaderPkt::Header::dataPacketLength</a></div><div class="ttdeci">unsigned dataPacketLength</div><div class="ttdoc">Actual length of the simulated Ethernet packet. </div><div class="ttdef"><b>Definition:</b> <a href="dist__packet_8hh_source.html#l00103">dist_packet.hh:103</a></div></div>
<div class="ttc" id="classDistIface_html_a4b8471da1e154b79dfff43ad5e5eb89d"><div class="ttname"><a href="classDistIface.html#a4b8471da1e154b79dfff43ad5e5eb89d">DistIface::distIfaceId</a></div><div class="ttdeci">unsigned distIfaceId</div><div class="ttdoc">Unique id for the dist link. </div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00494">dist_iface.hh:494</a></div></div>
<div class="ttc" id="classDistIface_html_ab6f1e2c0fac4506f5366c36200eacf98"><div class="ttname"><a href="classDistIface.html#ab6f1e2c0fac4506f5366c36200eacf98">DistIface::distIfaceNum</a></div><div class="ttdeci">static unsigned distIfaceNum</div><div class="ttdoc">Number of DistIface objects (i.e. </div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00490">dist_iface.hh:490</a></div></div>
<div class="ttc" id="classTCPIface_html_aaa359825e2a4755bed40d1770f40258c"><div class="ttname"><a href="classTCPIface.html#aaa359825e2a4755bed40d1770f40258c">TCPIface::accept</a></div><div class="ttdeci">void accept()</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00208">tcp_iface.cc:208</a></div></div>
<div class="ttc" id="tcp__iface_8hh_html"><div class="ttname"><a href="tcp__iface_8hh.html">tcp_iface.hh</a></div></div>
<div class="ttc" id="structTCPIface_1_1NodeInfo_html"><div class="ttname"><a href="structTCPIface_1_1NodeInfo.html">TCPIface::NodeInfo</a></div><div class="ttdoc">Compute node info and storage for the very first connection from each node (used by the switch) ...</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00083">tcp_iface.hh:83</a></div></div>
<div class="ttc" id="structTCPIface_1_1NodeInfo_html_aeba67daa9d5702f6288545ee14ccad54"><div class="ttname"><a href="structTCPIface_1_1NodeInfo.html#aeba67daa9d5702f6288545ee14ccad54">TCPIface::NodeInfo::distIfaceId</a></div><div class="ttdeci">unsigned distIfaceId</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00086">tcp_iface.hh:86</a></div></div>
<div class="ttc" id="classTCPIface_html_a9a00a8ef2111a15a581ecca88d6e2c97"><div class="ttname"><a href="classTCPIface.html#a9a00a8ef2111a15a581ecca88d6e2c97">TCPIface::sock</a></div><div class="ttdeci">int sock</div><div class="ttdoc">The stream socket to connect to the server. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00068">tcp_iface.hh:68</a></div></div>
<div class="ttc" id="classTCPIface_html_a86a6bd1ce169a168a4068ee292e74115"><div class="ttname"><a href="classTCPIface.html#a86a6bd1ce169a168a4068ee292e74115">TCPIface::nodes</a></div><div class="ttdeci">static std::vector&lt; std::pair&lt; NodeInfo, int &gt; &gt; nodes</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00089">tcp_iface.hh:89</a></div></div>
<div class="ttc" id="structTCPIface_1_1NodeInfo_html_a0c6b390d266e01a7311c2168bb514b57"><div class="ttname"><a href="structTCPIface_1_1NodeInfo.html#a0c6b390d266e01a7311c2168bb514b57">TCPIface::NodeInfo::distIfaceNum</a></div><div class="ttdeci">unsigned distIfaceNum</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00087">tcp_iface.hh:87</a></div></div>
<div class="ttc" id="inet_8hh_html_ab2b3adeb2a67e656ff030b56727fd0ac"><div class="ttname"><a href="inet_8hh.html#ab2b3adeb2a67e656ff030b56727fd0ac">length</a></div><div class="ttdeci">uint8_t length</div><div class="ttdef"><b>Definition:</b> <a href="inet_8hh_source.html#l00334">inet.hh:334</a></div></div>
<div class="ttc" id="logging_8hh_html_a8224a361dddd2ad59b411982e5ea746f"><div class="ttname"><a href="logging_8hh.html#a8224a361dddd2ad59b411982e5ea746f">warn</a></div><div class="ttdeci">#define warn(...)</div><div class="ttdef"><b>Definition:</b> <a href="logging_8hh_source.html#l00212">logging.hh:212</a></div></div>
<div class="ttc" id="arch_2x86_2process_8cc_html_a4a522b8848c4afad8c6404708a44a05f"><div class="ttname"><a href="arch_2x86_2process_8cc.html#a4a522b8848c4afad8c6404708a44a05f">M5_VAR_USED</a></div><div class="ttdeci">static const int NumArgumentRegs M5_VAR_USED</div><div class="ttdef"><b>Definition:</b> <a href="arch_2x86_2process_8cc_source.html#l00084">process.cc:84</a></div></div>
<div class="ttc" id="classDistIface_html"><div class="ttname"><a href="classDistIface.html">DistIface</a></div><div class="ttdoc">The interface class to talk to peer gem5 processes. </div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00101">dist_iface.hh:101</a></div></div>
<div class="ttc" id="logging_8hh_html_af5c59b879d6a32dc657018ab3d30198f"><div class="ttname"><a href="logging_8hh.html#af5c59b879d6a32dc657018ab3d30198f">panic_if</a></div><div class="ttdeci">#define panic_if(cond,...)</div><div class="ttdoc">Conditional panic macro that checks the supplied condition and only panics if the condition is true a...</div><div class="ttdef"><b>Definition:</b> <a href="logging_8hh_source.html#l00185">logging.hh:185</a></div></div>
<div class="ttc" id="classEventManager_html"><div class="ttname"><a href="classEventManager.html">EventManager</a></div><div class="ttdef"><b>Definition:</b> <a href="eventq_8hh_source.html#l00726">eventq.hh:726</a></div></div>
<div class="ttc" id="namespacesc__dt_html_acfe1beffdda4afa09e04790b737f4aab"><div class="ttname"><a href="namespacesc__dt.html#acfe1beffdda4afa09e04790b737f4aab">sc_dt::to_string</a></div><div class="ttdeci">const std::string to_string(sc_enc enc)</div><div class="ttdef"><b>Definition:</b> <a href="sc__fxdefs_8cc_source.html#l00060">sc_fxdefs.cc:60</a></div></div>
<div class="ttc" id="classTCPIface_html_a95f9efd9f1229dd04860b5dd36d0f27a"><div class="ttname"><a href="classTCPIface.html#a95f9efd9f1229dd04860b5dd36d0f27a">TCPIface::sendPacket</a></div><div class="ttdeci">void sendPacket(const Header &amp;header, const EthPacketPtr &amp;packet) override</div><div class="ttdoc">Send out a data packet to the remote end. </div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8cc_source.html#l00300">tcp_iface.cc:300</a></div></div>
<div class="ttc" id="classTCPIface_html_ada4f225fa79163f097f5be247a45fada"><div class="ttname"><a href="classTCPIface.html#ada4f225fa79163f097f5be247a45fada">TCPIface::serverPort</a></div><div class="ttdeci">int serverPort</div><div class="ttdef"><b>Definition:</b> <a href="tcp__iface_8hh_source.html#l00071">tcp_iface.hh:71</a></div></div>
<div class="ttc" id="classDistIface_html_a0e42826c555d71f76cb62c73db871c7d"><div class="ttname"><a href="classDistIface.html#a0e42826c555d71f76cb62c73db871c7d">DistIface::rank</a></div><div class="ttdeci">unsigned rank</div><div class="ttdoc">The rank of this process among the gem5 peers. </div><div class="ttdef"><b>Definition:</b> <a href="dist__iface_8hh_source.html#l00482">dist_iface.hh:482</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
Generated on Mon Nov 25 2019 12:52:08 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.8.13</small></address>
</body>
</html>
