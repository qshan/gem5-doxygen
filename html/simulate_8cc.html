<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>gem5: sim/simulate.cc File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">gem5
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fedf3bc7458de691f44ea68a2cf9143.html">sim</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">simulate.cc File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="simulate_8hh_source.html">sim/simulate.hh</a>&quot;</code><br />
<code>#include &lt;mutex&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
<code>#include &quot;<a class="el" href="logging_8hh_source.html">base/logging.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pollevent_8hh_source.html">base/pollevent.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="base_2types_8hh_source.html">base/types.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="async_8hh_source.html">sim/async.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="eventq__impl_8hh_source.html">sim/eventq_impl.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sim__events_8hh_source.html">sim/sim_events.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sim__exit_8hh_source.html">sim/sim_exit.hh</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="stat__control_8hh_source.html">sim/stat_control.hh</a>&quot;</code><br />
</div>
<p><a href="simulate_8cc_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a7d2706b05f0c4da961b8aa67ce8404a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEvent.html">Event</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#a7d2706b05f0c4da961b8aa67ce8404a7">doSimLoop</a> (<a class="el" href="classEventQueue.html">EventQueue</a> *)</td></tr>
<tr class="memdesc:a7d2706b05f0c4da961b8aa67ce8404a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">forward declaration  <a href="#a7d2706b05f0c4da961b8aa67ce8404a7">More...</a><br /></td></tr>
<tr class="separator:a7d2706b05f0c4da961b8aa67ce8404a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3858fd370e2d11aede1a80dba5c9ff2"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#ab3858fd370e2d11aede1a80dba5c9ff2">thread_loop</a> (<a class="el" href="classEventQueue.html">EventQueue</a> *queue)</td></tr>
<tr class="memdesc:ab3858fd370e2d11aede1a80dba5c9ff2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main function for all subordinate threads (i.e., all threads other than the main thread).  <a href="#ab3858fd370e2d11aede1a80dba5c9ff2">More...</a><br /></td></tr>
<tr class="separator:ab3858fd370e2d11aede1a80dba5c9ff2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a884c4af4f0e3a598820c81c1c368b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGlobalSimLoopExitEvent.html">GlobalSimLoopExitEvent</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#a3a884c4af4f0e3a598820c81c1c368b2">simulate</a> (<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> num_cycles)</td></tr>
<tr class="memdesc:a3a884c4af4f0e3a598820c81c1c368b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate for num_cycles additional cycles.  <a href="#a3a884c4af4f0e3a598820c81c1c368b2">More...</a><br /></td></tr>
<tr class="separator:a3a884c4af4f0e3a598820c81c1c368b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3a5d08b32f7a8d5d91cf0a21ee4a381"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#aa3a5d08b32f7a8d5d91cf0a21ee4a381">testAndClearAsyncEvent</a> ()</td></tr>
<tr class="memdesc:aa3a5d08b32f7a8d5d91cf0a21ee4a381"><td class="mdescLeft">&#160;</td><td class="mdescRight">Test and clear the global async_event flag, such that each time the flag is cleared, only one thread returns true (and thus is assigned to handle the corresponding async event(s)).  <a href="#aa3a5d08b32f7a8d5d91cf0a21ee4a381">More...</a><br /></td></tr>
<tr class="separator:aa3a5d08b32f7a8d5d91cf0a21ee4a381"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ad41feb6ead671893788fbca0edfafaf4"><td class="memItemLeft" align="right" valign="top">std::mutex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#ad41feb6ead671893788fbca0edfafaf4">asyncEventMutex</a></td></tr>
<tr class="memdesc:ad41feb6ead671893788fbca0edfafaf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for handling async events.  <a href="#ad41feb6ead671893788fbca0edfafaf4">More...</a><br /></td></tr>
<tr class="separator:ad41feb6ead671893788fbca0edfafaf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a573e4b44e5405d58cbe76faa6e5e9d52"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBarrier.html">Barrier</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#a573e4b44e5405d58cbe76faa6e5e9d52">threadBarrier</a></td></tr>
<tr class="memdesc:a573e4b44e5405d58cbe76faa6e5e9d52"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global barrier for synchronizing threads entering/exiting the simulation loop.  <a href="#a573e4b44e5405d58cbe76faa6e5e9d52">More...</a><br /></td></tr>
<tr class="separator:a573e4b44e5405d58cbe76faa6e5e9d52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0a6e478a8f9a3f4d5d44f9743aed332"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGlobalSimLoopExitEvent.html">GlobalSimLoopExitEvent</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="simulate_8cc.html#ac0a6e478a8f9a3f4d5d44f9743aed332">simulate_limit_event</a> = nullptr</td></tr>
<tr class="separator:ac0a6e478a8f9a3f4d5d44f9743aed332"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7d2706b05f0c4da961b8aa67ce8404a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d2706b05f0c4da961b8aa67ce8404a7">&#9670;&nbsp;</a></span>doSimLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEvent.html">Event</a> * doSimLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEventQueue.html">EventQueue</a> *&#160;</td>
          <td class="paramname"><em>eventq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>forward declaration </p>
<p>The main per-thread simulation loop.</p>
<p>This loop is executed by all simulation threads (the main thread and the subordinate threads) in parallel. </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00180">180</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

<p class="reference">References <a class="el" href="async_8cc_source.html#l00031">async_event</a>, <a class="el" href="async_8cc_source.html#l00036">async_exception</a>, <a class="el" href="async_8cc_source.html#l00034">async_exit</a>, <a class="el" href="async_8cc_source.html#l00035">async_io</a>, <a class="el" href="async_8cc_source.html#l00032">async_statdump</a>, <a class="el" href="async_8cc_source.html#l00033">async_statreset</a>, <a class="el" href="eventq_8hh_source.html#l00085">curEventQueue()</a>, <a class="el" href="sim_2core_8hh_source.html#l00047">curTick()</a>, <a class="el" href="eventq_8hh_source.html#l00654">EventQueue::empty()</a>, <a class="el" href="sim__events_8cc_source.html#l00090">exitSimLoop()</a>, <a class="el" href="eventq_8cc_source.html#l00430">EventQueue::handleAsyncInsertions()</a>, <a class="el" href="arch_2x86_2types_8hh_source.html#l00079">X86ISA::lock</a>, <a class="el" href="eventq_8hh_source.html#l00625">EventQueue::nextTick()</a>, <a class="el" href="pollevent_8cc_source.html#l00057">pollQueue</a>, <a class="el" href="stat__control_8cc_source.html#l00248">Stats::schedStatEvent()</a>, <a class="el" href="pollevent_8cc_source.html#l00188">PollQueue::service()</a>, <a class="el" href="eventq_8cc_source.html#l00204">EventQueue::serviceOne()</a>, and <a class="el" href="simulate_8cc_source.html#l00160">testAndClearAsyncEvent()</a>.</p>

<p class="reference">Referenced by <a class="el" href="simulate_8cc_source.html#l00083">simulate()</a>, and <a class="el" href="simulate_8cc_source.html#l00067">thread_loop()</a>.</p>

</div>
</div>
<a id="a3a884c4af4f0e3a598820c81c1c368b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a884c4af4f0e3a598820c81c1c368b2">&#9670;&nbsp;</a></span>simulate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalSimLoopExitEvent.html">GlobalSimLoopExitEvent</a>* simulate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&#160;</td>
          <td class="paramname"><em>num_cycles</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate for num_cycles additional cycles. </p>
<p>If num_cycles is -1 (the default), do not limit simulation; some other event must terminate the loop. Exported to Python. </p><dl class="section return"><dt>Returns</dt><dd>The SimLoopExitEvent that caused the loop to exit. </dd></dl>
<p>Delete the simulation quantum event. </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00083">83</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

<p class="reference">References <a class="el" href="sim_2core_8hh_source.html#l00047">curTick()</a>, <a class="el" href="global__event_8cc_source.html#l00084">BaseGlobalEvent::deschedule()</a>, <a class="el" href="simulate_8cc_source.html#l00180">doSimLoop()</a>, <a class="el" href="logging_8hh_source.html#l00175">fatal</a>, <a class="el" href="eventq_8hh_source.html#l00409">Event::globalEvent()</a>, <a class="el" href="miscregs__types_8hh_source.html#l00066">ArmISA::i</a>, <a class="el" href="logging_8hh_source.html#l00213">inform</a>, <a class="el" href="eventq_8cc_source.html#l00061">inParallelMode</a>, <a class="el" href="eventq_8cc_source.html#l00059">mainEventQueue</a>, <a class="el" href="base_2types_8hh_source.html#l00065">MaxTick</a>, <a class="el" href="eventq_8cc_source.html#l00058">numMainEventQueues</a>, <a class="el" href="eventq_8hh_source.html#l00172">EventBase::Progress_Event_Pri</a>, <a class="el" href="global__event_8cc_source.html#l00097">BaseGlobalEvent::reschedule()</a>, <a class="el" href="eventq_8cc_source.html#l00050">simQuantum</a>, <a class="el" href="simulate_8cc_source.html#l00067">thread_loop()</a>, and <a class="el" href="barrier_8hh_source.html#l00065">Barrier::wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RubySystem_8cc_source.html#l00135">RubySystem::memWriteback()</a>, <a class="el" href="python_2pybind11_2event_8cc_source.html#l00105">pybind_init_event()</a>, and <a class="el" href="RubySystem_8cc_source.html#l00332">RubySystem::startup()</a>.</p>

</div>
</div>
<a id="aa3a5d08b32f7a8d5d91cf0a21ee4a381"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3a5d08b32f7a8d5d91cf0a21ee4a381">&#9670;&nbsp;</a></span>testAndClearAsyncEvent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool testAndClearAsyncEvent </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Test and clear the global async_event flag, such that each time the flag is cleared, only one thread returns true (and thus is assigned to handle the corresponding async event(s)). </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00160">160</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

<p class="reference">References <a class="el" href="async_8cc_source.html#l00031">async_event</a>, and <a class="el" href="simulate_8cc_source.html#l00049">asyncEventMutex</a>.</p>

<p class="reference">Referenced by <a class="el" href="simulate_8cc_source.html#l00180">doSimLoop()</a>.</p>

</div>
</div>
<a id="ab3858fd370e2d11aede1a80dba5c9ff2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3858fd370e2d11aede1a80dba5c9ff2">&#9670;&nbsp;</a></span>thread_loop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void thread_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEventQueue.html">EventQueue</a> *&#160;</td>
          <td class="paramname"><em>queue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The main function for all subordinate threads (i.e., all threads other than the main thread). </p>
<p>These threads start by waiting on threadBarrier. Once all threads have arrived at threadBarrier, they enter the simulation loop concurrently. When they exit the loop, they return to waiting on threadBarrier. This process is repeated until the simulation terminates. </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00067">67</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

<p class="reference">References <a class="el" href="simulate_8cc_source.html#l00180">doSimLoop()</a>, and <a class="el" href="barrier_8hh_source.html#l00065">Barrier::wait()</a>.</p>

<p class="reference">Referenced by <a class="el" href="simulate_8cc_source.html#l00083">simulate()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad41feb6ead671893788fbca0edfafaf4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad41feb6ead671893788fbca0edfafaf4">&#9670;&nbsp;</a></span>asyncEventMutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::mutex asyncEventMutex</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mutex for handling async events. </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00049">49</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

<p class="reference">Referenced by <a class="el" href="simulate_8cc_source.html#l00160">testAndClearAsyncEvent()</a>.</p>

</div>
</div>
<a id="ac0a6e478a8f9a3f4d5d44f9743aed332"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0a6e478a8f9a3f4d5d44f9743aed332">&#9670;&nbsp;</a></span>simulate_limit_event</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalSimLoopExitEvent.html">GlobalSimLoopExitEvent</a>* simulate_limit_event = nullptr</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00075">75</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

</div>
</div>
<a id="a573e4b44e5405d58cbe76faa6e5e9d52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a573e4b44e5405d58cbe76faa6e5e9d52">&#9670;&nbsp;</a></span>threadBarrier</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBarrier.html">Barrier</a>* threadBarrier</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Global barrier for synchronizing threads entering/exiting the simulation loop. </p>

<p class="definition">Definition at line <a class="el" href="simulate_8cc_source.html#l00053">53</a> of file <a class="el" href="simulate_8cc_source.html">simulate.cc</a>.</p>

</div>
</div>
</div><!-- contents -->
<hr size="1"><address style="align: right;"><small>
Generated on Mon Nov 25 2019 12:52:13 for gem5 by <a href="http://www.doxygen.org/index.html"> doxygen</a> 1.8.13</small></address>
</body>
</html>
